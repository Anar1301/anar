<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Quick Quiz</title>
    <style>
      :root {
        --bg: #0f172a; /* slate-900 */
        --panel: #111827; /* gray-900 */
        --muted: #94a3b8; /* slate-400 */
        --text: #e5e7eb; /* gray-200 */
        --brand: #6366f1; /* indigo-500 */
        --brand-2: #22d3ee; /* cyan-400 */
        --ok: #10b981; /* emerald-500 */
        --bad: #ef4444; /* red-500 */
        --warn: #f59e0b; /* amber-500 */
        --card: #0b1220; /* deep panel */
        --shadow: 0 10px 25px rgba(0, 0, 0, 0.35);
      }
      html,
      body {
        height: 100%;
      }
      body {
        margin: 0;
        font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto,
          Inter, Helvetica, Arial, sans-serif;
        background: radial-gradient(
            1200px 600px at 80% -10%,
            rgba(34, 211, 238, 0.12),
            transparent 60%
          ),
          radial-gradient(
            1000px 500px at 0% 110%,
            rgba(99, 102, 241, 0.12),
            transparent 60%
          ),
          var(--bg);
        color: var(--text);
        display: grid;
        place-items: center;
        padding: 24px;
      }
      .app {
        width: min(920px, 100%);
      }
      .card {
        background: linear-gradient(
          180deg,
          rgba(255, 255, 255, 0.02),
          rgba(255, 255, 255, 0.01)
        );
        border: 1px solid rgba(148, 163, 184, 0.15);
        border-radius: 20px;
        box-shadow: var(--shadow);
        overflow: hidden;
      }
      header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 16px;
        padding: 20px 24px;
        background: rgba(17, 24, 39, 0.6);
        border-bottom: 1px solid rgba(148, 163, 184, 0.12);
      }
      header h1 {
        font-size: 20px;
        margin: 0;
        letter-spacing: 0.4px;
      }
      header .badges {
        display: flex;
        gap: 8px;
        align-items: center;
      }
      .badge {
        padding: 6px 10px;
        border-radius: 999px;
        border: 1px solid rgba(148, 163, 184, 0.25);
        color: var(--muted);
        font-weight: 600;
        font-size: 12px;
      }
      .timer.badge {
        border-color: rgba(245, 158, 11, 0.45);
        color: #fde68a;
      }

      main {
        padding: 24px;
        display: grid;
        gap: 18px;
      }

      .controls {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
        align-items: center;
      }
      .btn {
        appearance: none;
        border: none;
        border-radius: 14px;
        padding: 12px 16px;
        font-weight: 700;
        cursor: pointer;
        color: #0b1220;
        background: linear-gradient(180deg, #a5b4fc, #818cf8);
        box-shadow: 0 6px 16px rgba(99, 102, 241, 0.35);
      }
      .btn:hover {
        filter: brightness(1.02);
      }
      .btn.secondary {
        background: linear-gradient(180deg, #bae6fd, #67e8f9);
      }
      .btn.ghost {
        background: transparent;
        color: var(--text);
        border: 1px solid rgba(148, 163, 184, 0.25);
      }
      .btn:disabled {
        opacity: 0.55;
        cursor: not-allowed;
      }

      .row {
        display: flex;
        gap: 14px;
        align-items: center;
        flex-wrap: wrap;
      }

      .progress {
        height: 10px;
        background: rgba(148, 163, 184, 0.18);
        border-radius: 999px;
        overflow: hidden;
      }
      .progress .bar {
        height: 100%;
        width: 0%;
        background: linear-gradient(90deg, var(--brand), var(--brand-2));
        transition: width 0.3s ease;
      }

      .question {
        font-size: 22px;
        font-weight: 800;
        line-height: 1.3;
        margin: 8px 0 2px;
      }
      .meta {
        color: var(--muted);
        font-size: 14px;
      }

      .options {
        display: grid;
        gap: 12px;
        margin-top: 8px;
      }
      .option {
        display: flex;
        gap: 12px;
        align-items: center;
        background: var(--card);
        border: 1px solid rgba(148, 163, 184, 0.18);
        border-radius: 14px;
        padding: 14px 16px;
        cursor: pointer;
        transition: transform 0.06s ease, border-color 0.2s ease;
      }
      .option:hover {
        transform: translateY(-1px);
        border-color: rgba(99, 102, 241, 0.45);
      }
      .option input {
        appearance: none;
        width: 18px;
        height: 18px;
        border-radius: 999px;
        border: 2px solid rgba(148, 163, 184, 0.5);
        display: inline-grid;
        place-items: center;
      }
      .option input:checked {
        border-color: var(--brand);
      }
      .option.correct {
        border-color: rgba(16, 185, 129, 0.85);
        background: rgba(16, 185, 129, 0.08);
      }
      .option.wrong {
        border-color: rgba(239, 68, 68, 0.85);
        background: rgba(239, 68, 68, 0.08);
      }

      .hidden {
        display: none !important;
      }

      .split {
        display: grid;
        gap: 16px;
      }
      @media (min-width: 860px) {
        .split {
          grid-template-columns: 2fr 1fr;
        }
      }

      .panel {
        background: rgba(17, 24, 39, 0.55);
        border: 1px solid rgba(148, 163, 184, 0.12);
        border-radius: 16px;
        padding: 16px;
      }

      .list {
        display: grid;
        gap: 10px;
        max-height: 360px;
        overflow: auto;
      }
      .list .entry {
        display: grid;
        gap: 6px;
        padding: 10px 12px;
        border-radius: 12px;
        background: rgba(2, 6, 23, 0.4);
        border: 1px solid rgba(148, 163, 184, 0.1);
      }

      footer {
        padding: 14px 20px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        border-top: 1px solid rgba(148, 163, 184, 0.12);
        background: rgba(17, 24, 39, 0.6);
      }
      footer .hint {
        color: var(--muted);
        font-size: 12px;
      }

      a {
        color: #93c5fd;
      }
    </style>
  </head>
  <body>
    <div class="app card" role="application" aria-label="Quiz application">
      <header>
        <h1>Quick Quiz</h1>
        <div class="badges">
          <span class="badge" id="progressText">0 / 0</span>
          <span class="badge" id="scoreText">Score: 0</span>
          <span
            class="badge timer"
            id="timerBadge"
            title="Time left per question"
            >⏱ 00:15</span
          >
        </div>
      </header>

      <main>
        <!-- Setup screen -->
        <section id="setup">
          <div class="split">
            <div class="panel">
              <h2 style="margin: 8px 0 4px">Get started</h2>
              <p class="meta">
                Choose how many questions and whether to use the timer.
              </p>
              <div class="row" style="margin: 0.5rem 0 0">
                <label>
                  <input id="useTimer" type="checkbox" checked /> Use timer (15s
                  / question)
                </label>
              </div>
              <div class="row" style="margin: 0.5rem 0 1rem">
                <label for="count">Questions:</label>
                <select id="count">
                  <option value="5">5</option>
                  <option value="10" selected>10</option>
                  <option value="all">All</option>
                </select>
              </div>
              <div class="controls">
                <button class="btn" id="startBtn">Start Quiz ▶</button>
                <button
                  class="btn ghost"
                  id="shuffleBtn"
                  title="Shuffle the question pool"
                >
                  Shuffle Pool
                </button>
              </div>
            </div>
            <div class="panel">
              <h3 style="margin: 4px 0">High Scores (local)</h3>
              <div id="highscores" class="list" aria-live="polite"></div>
            </div>
          </div>
        </section>

        <!-- Quiz screen -->
        <section id="quiz" class="hidden" aria-live="polite">
          <div class="progress" aria-hidden="true">
            <div class="bar" id="progressBar"></div>
          </div>
          <div id="qMeta" class="meta">Category · Difficulty</div>
          <div id="qText" class="question">Question text</div>
          <div
            id="options"
            class="options"
            role="listbox"
            aria-label="Answer choices"
          ></div>
          <div class="controls">
            <button class="btn secondary" id="submitBtn" disabled>
              Submit
            </button>
            <button class="btn ghost" id="nextBtn" disabled>Next ➜</button>
          </div>
        </section>

        <!-- Results screen -->
        <section id="results" class="hidden">
          <div class="split">
            <div class="panel">
              <h2 style="margin: 0">Results</h2>
              <p class="meta" id="summaryText">You scored X/Y.</p>
              <div class="controls" style="margin: 8px 0 0">
                <button class="btn" id="playAgainBtn">Play Again</button>
                <button class="btn ghost" id="reviewBtn">Review Answers</button>
              </div>
              <form id="saveForm" class="row" style="margin-top: 10px">
                <input
                  id="playerName"
                  placeholder="Your name for the leaderboard"
                  aria-label="Your name"
                />
                <button class="btn secondary" type="submit">Save Score</button>
              </form>
            </div>
            <div class="panel">
              <h3 style="margin: 4px 0">Your Answers</h3>
              <div id="reviewList" class="list"></div>
            </div>
          </div>
        </section>
      </main>

      <footer>
        <span class="hint"
          >Shortcuts: 1-4 to select, Enter to submit/next.</span
        >
        <a href="#" id="exportBtn" title="Download your results as JSON"
          >Export results</a
        >
      </footer>
    </div>

    <script>
      // --- Quiz Data (edit this) ---
      const QUESTION_BANK = [
        {
          q: "Which language runs in a web browser?",
          options: ["Java", "C", "Python", "JavaScript"],
          answer: 3,
          cat: "Web",
          diff: "Easy",
        },
        {
          q: "What does CSS stand for?",
          options: [
            "Computer Style Sheets",
            "Cascading Style Sheets",
            "Creative Style System",
            "Colorful Style Source",
          ],
          answer: 1,
          cat: "Web",
          diff: "Easy",
        },
        {
          q: "Inside which HTML element do we put the JavaScript?",
          options: ["<javascript>", "<script>", "<js>", "<code>"],
          answer: 1,
          cat: "HTML",
          diff: "Easy",
        },
        {
          q: "Which method converts JSON to a JavaScript object?",
          options: [
            "JSON.parse()",
            "JSON.stringify()",
            "Object.toJSON()",
            "JSON.toObj()",
          ],
          answer: 0,
          cat: "JS",
          diff: "Easy",
        },
        {
          q: "Which array method creates a new array with elements that pass a test?",
          options: ["map", "forEach", "filter", "reduce"],
          answer: 2,
          cat: "JS",
          diff: "Medium",
        },
        {
          q: "Which CSS property controls text size?",
          options: ["font-style", "text-size", "font-weight", "font-size"],
          answer: 3,
          cat: "CSS",
          diff: "Easy",
        },
        {
          q: "What does HTML stand for?",
          options: [
            "Hyperlinks and Text Markup Language",
            "Home Tool Markup Language",
            "HyperText Markup Language",
            "Hyperlinking Text Managing Language",
          ],
          answer: 2,
          cat: "HTML",
          diff: "Easy",
        },
        {
          q: "Which symbol is used for comments in CSS?",
          options: [
            "// comment",
            "/* comment */",
            "<!-- comment -->",
            "# comment",
          ],
          answer: 1,
          cat: "CSS",
          diff: "Medium",
        },
        {
          q: "What keyword declares a block-scoped variable in JS?",
          options: ["var", "let", "def", "static"],
          answer: 1,
          cat: "JS",
          diff: "Easy",
        },
        {
          q: "Which HTML element is used for the largest heading?",
          options: ["<heading>", "<h6>", "<h1>", "<head>"],
          answer: 2,
          cat: "HTML",
          diff: "Easy",
        },
        {
          q: "What does DOM stand for?",
          options: [
            "Document Object Model",
            "Data Object Manager",
            "Digital Ordinance Model",
            "Document Oriented Map",
          ],
          answer: 0,
          cat: "Web",
          diff: "Medium",
        },
        {
          q: "Which of these is NOT a primitive type in JS?",
          options: ["string", "number", "boolean", "array"],
          answer: 3,
          cat: "JS",
          diff: "Medium",
        },
      ];

      // --- State ---
      let state = {
        pool: [],
        index: 0,
        score: 0,
        answers: [], // {picked, correctIndex}
        useTimer: true,
        timeLeft: 15,
        timerId: null,
      };

      // --- Elements ---
      const $ = (s) => document.querySelector(s);
      const setup = $("#setup");
      const quiz = $("#quiz");
      const results = $("#results");
      const qText = $("#qText");
      const qMeta = $("#qMeta");
      const optionsEl = $("#options");
      const progressBar = $("#progressBar");
      const progressText = $("#progressText");
      const scoreText = $("#scoreText");
      const timerBadge = $("#timerBadge");
      const submitBtn = $("#submitBtn");
      const nextBtn = $("#nextBtn");
      const startBtn = $("#startBtn");
      const shuffleBtn = $("#shuffleBtn");
      const countSel = $("#count");
      const useTimer = $("#useTimer");
      const summaryText = $("#summaryText");
      const reviewList = $("#reviewList");
      const highscores = $("#highscores");
      const playAgainBtn = $("#playAgainBtn");
      const reviewBtn = $("#reviewBtn");
      const saveForm = $("#saveForm");
      const playerName = $("#playerName");
      const exportBtn = $("#exportBtn");

      // --- Utils ---
      const shuffle = (arr) =>
        arr
          .map((v) => [Math.random(), v])
          .sort((a, b) => a[0] - b[0])
          .map((x) => x[1]);
      const clamp = (n, min, max) => Math.max(min, Math.min(max, n));
      const fmtTime = (s) =>
        `${String(Math.floor(s / 60)).padStart(2, "0")}:${String(
          s % 60
        ).padStart(2, "0")}`;

      function loadHighscores() {
        const list = JSON.parse(
          localStorage.getItem("quiz.highscores") || "[]"
        );
        highscores.innerHTML = list.length
          ? ""
          : '<p class="meta">No scores yet. Play a round!</p>';
        list.slice(0, 10).forEach((r, i) => {
          const div = document.createElement("div");
          div.className = "entry";
          div.innerHTML = `<strong>#${i + 1}</strong> ${r.name} — <em>${
            r.score
          }/${r.total}</em> (${Math.round(
            (100 * r.score) / r.total
          )}%) · ${new Date(r.at).toLocaleString()}`;
          highscores.appendChild(div);
        });
      }

      function saveHighscore(name) {
        const rec = {
          name: name || "Anonymous",
          score: state.score,
          total: state.pool.length,
          at: Date.now(),
        };
        const list = JSON.parse(
          localStorage.getItem("quiz.highscores") || "[]"
        );
        list.push(rec);
        list.sort((a, b) => b.score / b.total - a.score / a.total);
        localStorage.setItem(
          "quiz.highscores",
          JSON.stringify(list.slice(0, 50))
        );
        loadHighscores();
      }

      function setupPool() {
        let pool = [...QUESTION_BANK];
        const countVal = countSel.value;
        if (countVal !== "all") pool = pool.slice(0, Number(countVal));
        state.pool = pool;
        state.index = 0;
        state.score = 0;
        state.answers = [];
        state.timeLeft = 15;
        clearInterval(state.timerId);
        state.timerId = null;
        progressBar.style.width = "0%";
        progressText.textContent = `0 / ${state.pool.length}`;
        scoreText.textContent = `Score: 0`;
        timerBadge.textContent = `⏱ ${fmtTime(15)}`;
      }

      function startQuiz() {
        state.useTimer = useTimer.checked;
        setupPool();
        setup.classList.add("hidden");
        results.classList.add("hidden");
        quiz.classList.remove("hidden");
        renderQuestion();
      }

      function renderQuestion() {
        const { index, pool } = state;
        const item = pool[index];
        if (!item) {
          return endQuiz();
        }
        qText.textContent = item.q;
        qMeta.textContent = `${item.cat} · ${item.diff}`;
        progressText.textContent = `${index + 1} / ${pool.length}`;
        progressBar.style.width = `${(index / pool.length) * 100}%`;

        optionsEl.innerHTML = "";
        item.options.forEach((opt, i) => {
          const label = document.createElement("label");
          label.className = "option";
          label.innerHTML = `<input type="radio" name="opt" value="${i}" aria-label="Choice ${
            i + 1
          }"><span>${opt.replace(/</g, "&lt;")}</span>`;
          label.addEventListener("click", () => {
            submitBtn.disabled = false;
          });
          optionsEl.appendChild(label);
        });

        submitBtn.disabled = true;
        nextBtn.disabled = true;

        if (state.useTimer) {
          state.timeLeft = 15;
          timerBadge.textContent = `⏱ ${fmtTime(state.timeLeft)}`;
          clearInterval(state.timerId);
          state.timerId = setInterval(() => {
            state.timeLeft--;
            timerBadge.textContent = `⏱ ${fmtTime(
              Math.max(0, state.timeLeft)
            )}`;
            if (state.timeLeft <= 0) {
              clearInterval(state.timerId);
              autoSubmit();
            }
          }, 1000);
        } else {
          timerBadge.textContent = "⏱ OFF";
          clearInterval(state.timerId);
        }
      }

      function getPicked() {
        const checked = optionsEl.querySelector('input[name="opt"]:checked');
        return checked ? Number(checked.value) : null;
      }

      function autoSubmit() {
        // If nothing picked, mark wrong and reveal
        if (getPicked() == null) {
          reveal(null);
        } else {
          handleSubmit();
        }
      }

      function reveal(picked) {
        const { pool, index } = state;
        const correct = pool[index].answer;
        optionsEl.querySelectorAll(".option").forEach((opt, i) => {
          opt.classList.toggle("correct", i === correct);
          if (picked !== null)
            opt.classList.toggle("wrong", i === picked && picked !== correct);
        });
        nextBtn.disabled = false;
        submitBtn.disabled = true;
        clearInterval(state.timerId);
      }

      function handleSubmit() {
        const picked = getPicked();
        if (picked === null) return;
        const correct = state.pool[state.index].answer;
        const isRight = picked === correct;
        state.score += isRight ? 1 : 0;
        state.answers.push({
          picked,
          correctIndex: correct,
          q: state.pool[state.index].q,
          options: state.pool[state.index].options,
        });
        scoreText.textContent = `Score: ${state.score}`;
        reveal(picked);
      }

      function nextQuestion() {
        state.index++;
        if (state.index >= state.pool.length) {
          endQuiz();
          return;
        }
        renderQuestion();
      }

      function endQuiz() {
        quiz.classList.add("hidden");
        results.classList.remove("hidden");
        progressBar.style.width = "100%";
        progressText.textContent = `${state.pool.length} / ${state.pool.length}`;
        const pct = Math.round((100 * state.score) / state.pool.length);
        summaryText.textContent = `You scored ${state.score} / ${state.pool.length} (${pct}%).`;
        buildReview();
        clearInterval(state.timerId);
      }

      function buildReview() {
        reviewList.innerHTML = "";
        state.answers.forEach((a, idx) => {
          const div = document.createElement("div");
          div.className = "entry";
          const correctText = a.options[a.correctIndex];
          const userText =
            a.picked == null ? "<em>(no answer)</em>" : a.options[a.picked];
          div.innerHTML = `<strong>Q${idx + 1}.</strong> ${
            a.q
          }<div class="meta">Your: ${userText} · Correct: <strong>${correctText}</strong></div>`;
          reviewList.appendChild(div);
        });
      }

      // --- Events ---
      startBtn.addEventListener("click", startQuiz);
      shuffleBtn.addEventListener("click", () => {
        QUESTION_BANK.splice(
          0,
          QUESTION_BANK.length,
          ...shuffle(QUESTION_BANK)
        );
        alert("Question pool shuffled.");
      });
      submitBtn.addEventListener("click", handleSubmit);
      nextBtn.addEventListener("click", nextQuestion);
      useTimer.addEventListener("change", (e) => {
        timerBadge.textContent = e.target.checked ? "⏱ 00:15" : "⏱ OFF";
      });

      document.addEventListener("keydown", (e) => {
        const keyMap = { 1: 0, 2: 1, 3: 2, 4: 3 };
        if (keyMap[e.key] !== undefined) {
          const radios = optionsEl.querySelectorAll('input[name="opt"]');
          const idx = keyMap[e.key];
          if (radios[idx]) {
            radios[idx].checked = true;
            submitBtn.disabled = false;
          }
        }
        if (e.key === "Enter") {
          if (!quiz.classList.contains("hidden")) {
            if (!submitBtn.disabled) handleSubmit();
            else if (!nextBtn.disabled) nextQuestion();
          }
        }
      });

      playAgainBtn.addEventListener("click", () => {
        results.classList.add("hidden");
        setup.classList.remove("hidden");
      });

      reviewBtn.addEventListener("click", () => {
        reviewList.scrollIntoView({ behavior: "smooth" });
      });

      saveForm.addEventListener("submit", (e) => {
        e.preventDefault();
        saveHighscore(playerName.value.trim());
        playerName.value = "";
      });

      exportBtn.addEventListener("click", (e) => {
        e.preventDefault();
        const data = {
          score: state.score,
          total: state.pool.length,
          answers: state.answers,
          at: new Date().toISOString(),
        };
        const blob = new Blob([JSON.stringify(data, null, 2)], {
          type: "application/json",
        });
        const url = URL.createObjectURL(blob);
        const a = document.createElement("a");
        a.href = url;
        a.download = "quiz-results.json";
        a.click();
        URL.revokeObjectURL(url);
      });

      // Init
      loadHighscores();
      setupPool();
    </script>
  </body>
</html>
